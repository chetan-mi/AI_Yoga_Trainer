<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Forgot Password - Yoga Pose Detector</title>
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/style-login.css') }}"
    />
    
  </head>
  <body>
    <!-- Error Modal -->
    <div class="error-modal" id="errorModal">
      <div class="error-card">
        <div class="error-content">
          <div class="error-icon-container">
            <div class="error-icon-glow"></div>
            <div class="error-icon-wrapper">
              <svg class="error-icon" xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10"></path>
                <path d="M12 8v4"></path>
                <path d="M12 16h.01"></path>
              </svg>
            </div>
          </div>
          <div class="error-message">
            <h1 class="error-title">Passwords Don't Match</h1>
            <p class="error-description">The passwords you entered don't match. Please try again and make sure both passwords are identical.</p>
          </div>
          <button class="error-btn" onclick="closeErrorModal()">Try Again</button>
          <p class="error-help">Make sure caps lock is off and check for typos</p>
        </div>
      </div>
    </div>

    <div class="login-container">
      <div class="yoga-icon">üîë</div>

      <div class="logo">
        <h1>Reset Password</h1>
        <p>Enter your username to reset your password</p>
      </div>

      <!-- Flash Messages -->
      {% with messages = get_flashed_messages(with_categories=true) %} {% if
      messages %} {% for category, message in messages %}
      <div class="alert {{ category }}">{{ message }}</div>
      {% endfor %} {% endif %} {% endwith %}

      <form method="POST" id="forgotPasswordForm">
        <div class="form-group">
          <label for="username">Username</label>
          <input
            type="text"
            id="username"
            name="username"
            placeholder="Enter your username"
            required
          />
        </div>

        <div class="form-group">
          <label for="email">Email Address</label>
          <input
            type="email"
            id="email"
            name="email"
            placeholder="Enter your registered email"
            required
          />
        </div>

        <div class="form-group">
          <label for="new_password">New Password</label>
          <input
            type="password"
            id="new_password"
            name="new_password"
            placeholder="Enter new password"
            required
            minlength="6"
          />
          <button
            type="button"
            class="password-toggle"
            onclick="togglePassword('new_password')"
          >
            üëÅÔ∏è
          </button>
        </div>

        <div class="form-group">
          <label for="confirm_password">Confirm New Password</label>
          <input
            type="password"
            id="confirm_password"
            name="confirm_password"
            placeholder="Confirm new password"
            required
          />
          <button
            type="button"
            class="password-toggle"
            onclick="togglePassword('confirm_password')"
          >
            üëÅÔ∏è
          </button>
        </div>

        <button type="submit" class="btn" id="resetBtn">Reset Password</button>
      </form>

      <div class="register-link">
        Remember your password?
        <a href="{{ url_for('login') }}">Back to Login</a>
      </div>
    </div>

    <script>
      function togglePassword(fieldId) {
        const field = document.getElementById(fieldId);
        const type =
          field.getAttribute("type") === "password" ? "text" : "password";
        field.setAttribute("type", type);
      }

      function showErrorModal() {
        document.getElementById("errorModal").classList.add("active");
      }

      function closeErrorModal() {
        document.getElementById("errorModal").classList.remove("active");
        // Clear password fields
        document.getElementById("new_password").value = "";
        document.getElementById("confirm_password").value = "";
        // Focus on new password field
        document.getElementById("new_password").focus();
      }

      // Form validation
      document
        .getElementById("forgotPasswordForm")
        .addEventListener("submit", function (e) {
          const newPassword = document.getElementById("new_password").value;
          const confirmPassword =
            document.getElementById("confirm_password").value;

          if (newPassword !== confirmPassword) {
            e.preventDefault();
            showErrorModal();
            return false;
          }

          if (newPassword.length < 6) {
            e.preventDefault();
            alert("Password must be at least 6 characters long!");
            return false;
          }
        });

      // Keyboard support for error modal
      document.addEventListener("keydown", function (e) {
        if (e.key === "Escape" && document.getElementById("errorModal").classList.contains("active")) {
          closeErrorModal();
        }
      });
    </script>
  </body>
</html>
